# -*- coding: utf-8 -*-
"""
test_5th_order

Created on 2018-02-12 by hbldh <henrik.blidh@nedomkull.com>

"""

import pytest
from dlxsudoku import Sudoku


s1 = """
# Really hard fifth order Sudoku.
0 0 12 6 0 0 7 0 18 0 5 24 0 10 1 0 0 4 0 0 0 0 0 0 0 
2 0 19 0 13 0 0 0 10 0 0 0 0 0 0 0 0 18 5 0 0 0 0 0 1 
0 0 0 0 0 0 0 22 0 0 0 0 3 0 2 0 0 14 12 0 16 8 25 0 0 
0 16 0 0 0 2 23 0 0 13 12 22 0 0 0 21 15 19 3 0 0 0 0 14 0 
23 0 24 0 0 0 0 0 25 8 4 0 16 19 21 0 0 7 0 0 0 3 12 0 9 
0 4 0 2 0 0 0 0 0 0 0 10 0 24 12 17 16 0 0 0 5 0 0 0 0 
0 0 9 0 0 6 25 0 0 0 8 0 5 3 0 0 0 0 0 0 20 0 0 18 19 
15 0 10 11 0 0 0 18 12 19 0 0 0 0 0 0 0 23 0 0 7 0 0 4 0 
0 0 0 0 0 0 0 14 0 22 0 0 18 16 20 0 6 11 13 0 0 0 0 0 0 
0 22 0 25 0 0 1 17 5 4 7 0 0 14 0 8 3 21 0 0 11 0 0 0 6 
0 20 13 15 0 0 0 0 0 0 9 0 0 2 0 25 0 1 8 0 0 5 0 21 0 
0 1 0 0 0 0 16 10 0 7 0 0 4 20 0 0 9 0 0 14 0 24 0 17 0 
25 2 5 0 0 0 0 0 13 0 0 0 0 0 22 0 0 0 0 0 19 1 8 0 0 
0 0 7 21 0 0 12 0 2 17 0 0 0 18 6 16 0 0 15 0 0 13 0 10 0 
8 10 18 12 16 9 0 0 0 5 0 0 0 0 19 0 0 17 0 21 0 15 0 0 22 
0 8 0 0 15 0 3 0 6 0 21 0 0 7 0 18 14 5 0 1 0 0 0 0 0 
0 0 0 19 0 1 0 16 11 0 0 0 10 22 25 15 0 0 0 0 0 0 21 0 0 
0 3 1 0 21 0 0 4 0 0 0 0 2 0 13 0 24 25 0 0 14 0 0 6 0 
0 0 0 0 0 0 0 15 0 12 14 0 6 17 24 0 0 0 0 0 0 0 13 0 0 
0 5 23 16 4 0 13 24 7 2 0 9 0 0 15 3 0 22 0 0 0 0 0 0 8 
0 0 25 20 2 0 19 0 0 0 0 1 0 0 0 0 21 3 0 0 12 0 0 0 0 
16 12 0 5 0 11 21 0 23 0 0 15 0 0 0 0 19 9 0 0 0 0 0 25 10 
0 0 0 0 9 20 22 7 4 0 3 0 14 25 18 0 11 0 0 0 0 0 1 0 15 
24 0 6 0 22 8 0 25 14 0 10 11 0 9 0 20 1 16 0 7 0 23 0 0 13 
14 13 21 1 0 0 5 0 0 0 6 0 22 0 23 10 0 0 0 2 0 0 18 7 11
""".strip()


s2 = """# Not very hard fifth order Sudoku
V L 0 0 0 0 E C N 0 0 0 0 M F 0 0 I 0 R T 0 D W B
M P 0 0 0 0 J O 0 0 0 I Y 0 0 0 Q 0 0 T R 0 0 G 0
0 0 C 0 N I W X P 0 O D 0 0 E L 0 0 M S 0 0 A 0 0
X 0 B Y 0 L R H D 0 A 0 0 0 N C 0 G W 0 0 M F S U
0 I H 0 O 0 U 0 0 0 R 0 W B G V N 0 0 0 C L 0 0 0
Y 0 0 0 0 0 0 G V 0 0 0 A 0 I S C 0 Q 0 M 0 0 0 D
L 0 G F V P 0 0 0 S 0 E N 0 0 0 0 0 H 0 0 Q Y 0 0
0 0 P A 0 U 0 J 0 0 0 B O V 0 M 0 0 0 Y 0 S 0 R W
E W Q H 0 0 0 K R 0 X Y 0 0 0 0 A O 0 V U I 0 0 P
0 T 0 0 S Y 0 0 O D 0 0 0 P 0 0 G 0 0 U A 0 0 0 0
P 0 T 0 0 D V 0 J 0 0 0 0 Y 0 U R 0 I 0 K 0 0 M N
G H 0 0 R 0 0 E 0 O 0 0 0 X M 0 0 K 0 0 S 0 C 0 T
0 Y W 0 X S M 0 0 K 0 Q F N 0 P 0 0 D C V 0 U I 0
D 0 F 0 L 0 0 T 0 0 U K 0 0 0 Q 0 N 0 0 Y 0 0 O H
Q N 0 0 B 0 H 0 Y U 0 G 0 0 0 0 V 0 T A 0 0 J 0 L
0 0 0 0 H O 0 0 B 0 0 U 0 0 0 R S 0 0 N P 0 0 F 0
S 0 0 O Y V 0 N W 0 0 0 0 A B 0 L J 0 0 0 U T D K
J M 0 T 0 G 0 0 0 A 0 O X K 0 0 0 F 0 H 0 N R 0 0
0 0 V B 0 0 L 0 0 0 0 0 I D 0 O 0 0 0 K X A W 0 G
I 0 0 0 A 0 C 0 F E J 0 L 0 0 0 W Y 0 0 0 0 0 0 M
0 0 0 R C 0 0 0 G Y K S H 0 U 0 0 0 O 0 N 0 M L 0
T S E P 0 0 A M 0 F N 0 0 0 L 0 J W Y Q 0 V X 0 R
0 0 Y 0 0 R O 0 0 H D 0 0 J Q 0 U S X I G 0 K 0 0
0 K 0 0 G T 0 0 E 0 0 0 R O 0 0 0 B C 0 0 0 0 U J
O U N 0 W Q 0 L 0 0 F M 0 0 0 0 K E R 0 0 0 0 H A
"""

s2_string_representation = """# Not very hard fifth order Sudoku
+----------------------+----------------------+----------------------+----------------------+----------------------+
|  22  12   *   *   *  |   *   5   3  14   *  |   *   *   *  13   6  |   *   *   9   *  18  |  20   *   4  23   2  |
|  13  16   *   *   *  |   *  10  15   *   *  |   *   9  25   *   *  |   *  17   *   *  20  |  18   *   *   7   *  |
|   *   *   3   *  14  |   9  23  24  16   *  |  15   4   *   *   5  |  12   *   *  13  19  |   *   *   1   *   *  |
|  24   *   2  25   *  |  12  18   8   4   *  |   1   *   *   *  14  |   3   *   7  23   *  |   *  13   6  19  21  |
|   *   9   8   *  15  |   *  21   *   *   *  |  18   *  23   2   7  |  22  14   *   *   *  |   3  12   *   *   *  |
+----------------------+----------------------+----------------------+----------------------+----------------------+
|  25   *   *   *   *  |   *   *   7  22   *  |   *   *   1   *   9  |  19   3   *  17   *  |  13   *   *   *   4  |
|  12   *   7   6  22  |  16   *   *   *  19  |   *   5  14   *   *  |   *   *   *   8   *  |   *  17  25   *   *  |
|   *   *  16   1   *  |  21   *  10   *   *  |   *   2  15  22   *  |  13   *   *   *  25  |   *  19   *  18  23  |
|   5  23  17   8   *  |   *   *  11  18   *  |  24  25   *   *   *  |   *   1  15   *  22  |  21   9   *   *  16  |
|   *  20   *   *  19  |  25   *   *  15   4  |   *   *   *  16   *  |   *   7   *   *  21  |   1   *   *   *   *  |
+----------------------+----------------------+----------------------+----------------------+----------------------+
|  16   *  20   *   *  |   4  22   *  10   *  |   *   *   *  25   *  |  21  18   *   9   *  |  11   *   *  13  14  |
|   7   8   *   *  18  |   *   *   5   *  15  |   *   *   *  24  13  |   *   *  11   *   *  |  19   *   3   *  20  |
|   *  25  23   *  24  |  19  13   *   *  11  |   *  17   6  14   *  |  16   *   *   4   3  |  22   *  21   9   *  |
|   4   *   6   *  12  |   *   *  20   *   *  |  21  11   *   *   *  |  17   *  14   *   *  |  25   *   *  15   8  |
|  17  14   *   *   2  |   *   8   *  25  21  |   *   7   *   *   *  |   *  22   *  20   1  |   *   *  10   *  12  |
+----------------------+----------------------+----------------------+----------------------+----------------------+
|   *   *   *   *   8  |  15   *   *   2   *  |   *  21   *   *   *  |  18  19   *   *  14  |  16   *   *   6   *  |
|  19   *   *  15  25  |  22   *  14  23   *  |   *   *   *   1   2  |   *  12  10   *   *  |   *  21  20   4  11  |
|  10  13   *  20   *  |   7   *   *   *   1  |   *  15  24  11   *  |   *   *   6   *   8  |   *  14  18   *   *  |
|   *   *  22   2   *  |   *  12   *   *   *  |   *   *   9   4   *  |  15   *   *   *  11  |  24   1  23   *   7  |
|   9   *   *   *   1  |   *   3   *   6   5  |  10   *  12   *   *  |   *  23  25   *   *  |   *   *   *   *  13  |
+----------------------+----------------------+----------------------+----------------------+----------------------+
|   *   *   *  18   3  |   *   *   *   7  25  |  11  19   8   *  21  |   *   *   *  15   *  |  14   *  13  12   *  |
|  20  19   5  16   *  |   *   1  13   *   6  |  14   *   *   *  12  |   *  10  23  25  17  |   *  22  24   *  18  |
|   *   *  25   *   *  |  18  15   *   *   8  |   4   *   *  10  17  |   *  21  19  24   9  |   7   *  11   *   *  |
|   *  11   *   *   7  |  20   *   *   5   *  |   *   *  18  15   *  |   *   *   2   3   *  |   *   *   *  21  10  |
|  15  21  14   *  23  |  17   *  12   *   *  |   6  13   *   *   *  |   *  11   5  18   *  |   *   *   *   8   1  |
+----------------------+----------------------+----------------------+----------------------+----------------------+
""".strip()


def test_parsing_s1():
    order, comment, matrix = Sudoku._parse_from_string(s1)
    assert order == 5
    assert comment == "# Really hard fifth order Sudoku."
    assert len(matrix) == 25
    assert len(matrix[0]) == 25


@pytest.mark.skip(reason="DLXSudoku cannot solve this in "
                         "reasonable time as of yet...")
def test_solving_s1():
    s = Sudoku(s1)
    s.solve()
    assert s.is_solved


def test_parsing_s2():
    order, comment, matrix = Sudoku._parse_from_string(s2)
    assert order == 5
    assert comment == "# Not very hard fifth order Sudoku"
    assert len(matrix) == 25
    assert len(matrix[0]) == 25


def test_solving_s2():
    s = Sudoku(s2)
    s.solve()
    assert s.is_solved


def test_string_representation_s2():
    s = Sudoku(s2)
    string_rep = str(s)
    assert string_rep == s2_string_representation
